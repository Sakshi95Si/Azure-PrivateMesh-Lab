# Azure Private DNS Zone Setup

## 1. Create the Private DNS Zone

- Search for Private DNS Zones and click + Create.

- Choose your subscription and resource group. Region should be the same as that of  Vnet region that needs to be attached with the zone.

- Enter a DNS zone name (e.g., internal.Quantumspace.com)

- Click Review + Create, then Create.

![PD](Screenshots/imgpdn1.png)

## 2. Link Azure VNets to the DNS Zone

- Once the zone is created, open it.

- Go to Virtual Network Links > + Add.

- Give the name of the Link: Zone-Link-Hub

- Select your hub VNet (and optionally spoke VNets).

- Enable Auto-registration if you want Azure VMs to register automatically.

![PD](Screenshots/imgpdn2.png)

![PD](Screenshots/imgpdn3.png)

![PD](Screenshots/imgpdn4.png)

## 3. Deploy Azure DNS Private Resolver

This allows DNS queries from on-prem to resolve Azure private DNS names.

- Create a DNS Private Resolver in the hub VNet. Give name and select vnet-hub and go next.

![PD](Screenshots/imgpdn5.png)

- Add: Inbound endpoint: For on-prem DNS servers to forward queries.

![PD](Screenshots/imgpdn6.png)

- Outbound endpoint: For forwarding queries to Azure DNS (if needed).

![PD](Screenshots/imgpdn7.png)

## Configure DNS forwarding ruleset to forward queries for internal.contoso.com to Azure DNS.

![PD](Screenshots/imgpdn8.png)

![PD](Screenshots/imgpdn9.png)

## 4. Configure On-Prem DNS Forwarding

- On your on-prem DNS server (e.g., Windows Server DNS): Add a conditional forwarder for internal.Quantumspace.com.

- Point it to the inbound endpoint IP of the Azure DNS Private Resolver.

![PD](Screenshots/imgpdn10.png)

## 5. Create A record in the zone for VM in spoke1 vnet.

- Go to the private zone created> Recordset +Add

- Give the name and server private IP

![PD](Screenshots/imgpdn11.png)

## 6. Verify Resolution Inbound & outbound DNS queries

- From an on-prem client, run: nslookup vmname.internal.Quantumspace.com

- You should get the private IP of the Azure VM

![PD](Screenshots/imgpdn12.png)

![PD](Screenshots/imgpdn13.png)

From Azure VM, run: nslookup ADDC 176.16.0.1

